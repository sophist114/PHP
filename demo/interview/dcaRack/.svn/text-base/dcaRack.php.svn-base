<?php
require_once(dirname(__FILE__)."/../../../class/DCADiagram.Class.php");

$clusterId = getPost('clusterId');
$clusterName = getPost('clusterName');
$latestEventId = getPost('latestEventId');

$dcaDiagram = new DCADiagram();
$dcaDiagramData = $dcaDiagram->getDiagramData($clusterId, $clusterName, $latestEventId);

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>DCA Diagram</title>
<link rel="stylesheet" href="css/dcaRack.css" type="text/css" />
</head>   
<body> 
<div class="rack_wrap">
	<div id="rackdiv"></div>
</div> 
<script type="text/javascript" src="javascript/jquery/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="javascript/templates/jquery.tmpl.min.js"></script>
<script type="text/javascript" src="javascript/dcaRack.js"></script>
<script type="text/javascript">
var dcaDiagramData = <?php echo $dcaDiagramData; ?>;
var clusterInfo = {rackId: "EMC1000"};
$(document).ready(function() {
	var loadingObj = parent.document.getElementById('loadingDiagram');
	if(loadingObj) loadingObj.style.display = 'none';
	$('#rackdiv').buildDCA(clusterInfo);
});
</script>
<!--[if IE]>
<style>
	.dca_thumbs li{
		margin: 0;
		padding: 0;
		display:inline;
		vertical-align: bottom;
		width: 146px;
		border-collapse: collapse;
		border: none none;

	}
	div.rackImg .server_wrap.half{top:11px;}
	.dca_thumbs li img{
		width: 146px;
		vertical-align: bottom;
		border: none none;
		border-collapse: collapse;
	}
	.dca_thumbs li img.blank{height:14.5px;}
	.half .dca_thumbs li img.R610{height:14px;}
	.half .dca_thumbs li img.brocadeSwitch{height:14px;}
	.half .dca_thumbs li img.adminSwitch{height:14px;}
	.half .dca_thumbs li img.blank{height:10.13pt;}
	.full .dca_thumbs li img.blank{height:15px;}

	.dca_thumbs li img.c_back{
		margin-top:-2px;
		margin-bottom:-1.5px;
	}
	.dca_thumbs li img.c_back.adminSwich{height:13px;}
	.dca_thumbs li img.c_back.R610{height:13px;}
	.dca_thumbs li img.c_front{
		margin-top:-2px;
		margin-bottom:-1.5px;
		display:inline;
	}
	#rackwrap .dca_thumbs li{font-size: 0;}
	.server_wrap.half{top:9px;}

	#racknavi{width:667px;}
</style>
<![endif]-->
<script id="CompInfotemp" type="text/x-jquery-tmpl">
	<h3><img class="gp_logo" src='images/logo_greenplum.png' title='Greenplum Logo'>Component Summary :</h3>
	<ul id="comInfo" class="comInfo">
	{{if (chassis =='adminSwitch')}}
		<li><span> IP : </span> ${ip} </li>
		<li><span> Switch Model : </span> ${model} </li>
		<li><span> Chassis size : </span> ${chassisSize} </li>
		<li><span> Type : </span> ${chassis}</li>
	{{else (chassis =='brocadeSwitch')}}
		<li><span> Switch Model : </span> ${model} </li>
		<li><span> Type : </span> ${chassis}</li>
		<li><span> Firmware : </span> 2.1.1 </li>
		<li><span> Bootprom : </span> ${bootProm} </li>
		<li><span> FoS : </span> ${FoS} </li>
		<li><span> Chassis size : </span> ${chassisSize} </li>
		<li><span> IP : </span> ${ip} </li>
	{{else}}  
		<li><span  class="li-child">Serial Number : </span> ${serialNum}&nbsp; </li>
		<li><span class='li-child'> Admin Network IP : </span>${ip}&nbsp; </li>
		<li><span class='li-child'> InterConnect IP1 : </span>${InterConnectIP1}&nbsp; </li>
		<li><span class='li-child'> InterConnect IP2 : </span>${InterConnectIP2}&nbsp; </li>
		<li><span> Chassis size : </span> ${chassisSize} &nbsp; </li>
		<li><span> Server : </span> ${chassis} &nbsp; </li>
		<li><span> CPU model : </span> Intel Xeon 5500 processor&nbsp; </li>
		<li><span>Number of CPU : </span> ${CPUnum}  &nbsp; </li>
		<li><span>Number of Core : </span> ${CPUcores} &nbsp; </li>
		<li><span> Memory : </span> ${memory} &nbsp; </li>
		<li><span> Server Status : </span> ${healthCheck} &nbsp; </li>
		<li><span> Total Disk Space : </span><br />
				  <table id='list-table'>
				  </table>
		&nbsp; </li>
	{{/if}}	
	</ul>
</script>
</body> 
</html>